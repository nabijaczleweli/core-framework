"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var i=0;t.length>i;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),preloader=function(){function e(t){_classCallCheck(this,e),this.onComplete=t,this.config={cache:!0,parallel:!0},this.time={start:0,end:0},this.total=0,this.images=[],this._queue=[];for(var i=arguments.length,n=Array(i>1?i-1:0),a=1;i>a;a++)n[a-1]=arguments[a];t&&n&&(this.enqueue.apply(this,n),this.preload())}return _createClass(e,null,[{key:"getTimestamp",value:function(){var e=window.performance.now||window.performance.webkitNow;return e?e.call(window.performance):(new Date).getTime()}}]),_createClass(e,[{key:"enqueue",value:function(){for(var e=arguments.length,t=Array(e),i=0;e>i;i++)t[i]=arguments[i];return this._queue=this._queue.concat(t.map(function(e){return"string"==typeof e?{source:e}:e})),this}},{key:"_finish",value:function(e,t){--this.total,this.images.forEach(function(i){i.index==e&&(i.size={width:t.width,height:t.heigth})}),this.total||(this.time.end=(new Date).getTime(),this.onComplete({time:Math.round(this.time.end-this.time.start),images:this.images}))}},{key:"preload",value:function(t){var i=this;this.onComplete=t||this.onComplete,this.time.start=e.getTimestamp(),this.total=this._queue.length;for(var n=function(t){var n=new Image;i.images.push({index:t,image:n,size:{width:0,height:0}}),n.onload=n.onerror=n.onabort=function(){return i._finish(t,n)},n.src=i._queue[t].source+(i.config.cache?"":"?__preloader_cache_invalidator="+e.getTimestamp())},a=this.total;--a;)n(a)}}]),e}();exports["default"]=preloader,module.exports=exports["default"];
